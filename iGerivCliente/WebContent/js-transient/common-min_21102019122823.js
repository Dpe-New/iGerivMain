var cal_obj2=null,formElement=null,format="%d/%m/%Y",errorMessage,errorMessageDelete,okMessage,okMessageDelete,nessunaPubblicazione,chiudiLabel,submitButton,reportImage,reportImageHref,lastKeypressCode,lastFocusedFieldId,firstInvalidId="",pingFailureCount=0,lastFocusedRow="",lastFocusColor="",popupWiderThanViewport=false;
$.alt=function(a,c,b,d){var e=false;$(document).keydown(function(f){b||(b=[]);if(f.altKey)e=true;d=typeof d==="undefined"||d===""?a.charCodeAt(0):d;if(f.keyCode==d&&e){if(f.preventDefault)f.preventDefault();else f.returnValue=false;c.apply(this,b);return false}}).keyup(function(){e=false})};
$.altPlus=function(a,c){var b=false;$(document).keydown(function(d){c||(c=[]);if(d.altKey)b=true;var e=null;if(!d)d=window.event;if(d.keyCode)e=d.keyCode;else if(d.which)e=d.which;if((String.fromCharCode(e)=="+"||e==171||e==187||e==107)&&b){if(d.preventDefault)d.preventDefault();else d.returnValue=false;a.apply(this,c);return false}}).keyup(function(){b=false})};
$.altMinus=function(a,c){var b=false;$(document).keydown(function(d){c||(c=[]);if(d.altKey)b=true;var e=null;if(!d)d=window.event;if(d.keyCode)e=d.keyCode;else if(d.which)e=d.which;if((String.fromCharCode(e)=="-"||e==173||e==189||e==109)&&b){if(d.preventDefault)d.preventDefault();else d.returnValue=false;a.apply(this,c);return false}}).keyup(function(){b=false})};
$.ctrl=function(a,c,b){var d=false;$(document).keydown(function(e){b||(b=[]);if(e.ctrlKey)d=true;if(e.keyCode==a.charCodeAt(0)&&d){if(e.preventDefault)e.preventDefault();else e.returnValue=false;c.apply(this,b);return false}}).keyup(function(){d=false})};
$.shift=function(a,c,b,d){var e=false;$(document).keydown(function(f){b||(b=[]);if(f.shiftKey)e=true;d=typeof d==="undefined"||d===""?a.charCodeAt(0):d;if(f.keyCode==d&&e){if(f.preventDefault)f.preventDefault();else f.returnValue=false;c.apply(this,b);return false}}).keyup(function(){e=false})};$.ctrl("E",function(){var a=$("img[src*='pdf.gif']").first();a.length>0&&a.trigger("click")});$.ctrl("X",function(){var a=$("img[src*='xls.gif']").first();a.length>0&&a.trigger("click")});
$.ctrl("M",function(){var a="",c="";if($("#popup_name").is(":visible"))a=$("#popup_name").find("form");else if($("#popup_name_det").is(":visible"))a=$("#popup_name_det").find("form");if(a.length>0)a.each(function(){c=$(this).find("input[value='"+memorizza+"']").first();if(c.length>0){c.trigger("click");return false}});else c=$("input[value='"+memorizza+"']").first();c.trigger("click")});$.ctrl("I",function(){$("#memorizzaInvia").length>0&&$("#memorizzaInvia").trigger("click")});
$(this).bind("keydown",function(a){lastKeypressCode=a.keyCode?a.keyCode:a.charCode;switch(a.keyCode?a.keyCode:a.charCode){case 27:if($("#popup_name").is(":visible")||$("#popup_name_det").is(":visible")||$("#treeContiContainer").is(":visible"))$("#close").trigger("click")}});$("input[id*=memorizza],input[id*=cancella],input[id*=ricerca],input[id*=submit]").click(disableSubmitButton);$("img[src*='pdf.gif'],img[src*='xls.gif']").click(function(){blockUIForDownload($(this))});
function setMenuListWidths(){if($(window).width()<=1024)getBrowser().indexOf("MSIE")!=-1?$("#mydroplinemenu ul").css({"font-size":"10px"}):$("#mydroplinemenu ul").css({"font-size":"11px"});else if($(window).width()>1024&&$(window).width()<=1280){$("#mydroplinemenu ul li").css({"font-size":"12px"});$("#mydroplinemenu ul li a:not(ul li ul li a)").each(function(){$(this).css({padding:"9px 0px 5px 20px"})})}else if($(window).width()>1280&&$(window).width()<=1440){$("#mydroplinemenu ul").css({"font-size":"13px"});
$("#mydroplinemenu ul li a:not(ul li ul li a)").each(function(){$(this).css({padding:"9px 0px 10px 20px"})})}else{$("#mydroplinemenu ul").css({"font-size":"13px"});$("#mydroplinemenu ul li a:not(ul li ul li a)").each(function(){$(this).css({padding:"9px 0px 10px 25px"})})}}function PlaySound(a){if(allowBeep=="true")try{var c=document.getElementById(a);if(c)try{c.Play()}catch(b){c.play()}}catch(d){}}
function disableSubmitButton(a){a=a.target?a.target:a.srcElement?a.srcElement:null;if(a.type=="submitButton"||a.type=="button"){submitButton=$("#"+a.id);submitButton.attr("disabled",true);ray.ajax()}}function clearPubblicazioniFilterFields(){$("#titolo").val("");$("#sottotitolo").val("");$("#argomento").val("");$("#periodicita").val("");$("#prezzo").val("");$("#codPubblicazione").val("");$("#codBarre").val("")}var fileDownloadCheckTimer;
function setLastFocusedElement(a){if(typeof a==="undefined"||a=="")a=window.document;$("input[type='text'], input[type='file'], select, button",a).focus(function(){var c=$(this).attr("type");if(typeof c!=="undefined"&&(c=="text"||c=="file"||c=="select-one"))lastFocusedFieldId=this.id})}
function blockUIForDownload(){if(areCookiesEnabled()){var a=(new Date).getTime();if($("#popup_name_det").is(":visible")){$("#downloadToken2").length>0?$("#downloadToken2").val(a):$('input[name="downloadToken2"]').val(a);if($("#downloadToken2").length>0&&$("#downloadToken2").val().length>0||$('input[name="downloadToken2"]').length>0&&$('input[name="downloadToken2"]').val().length>0)ray1.ajax()}else if($("#popup_name").is(":visible")){$("#downloadToken1").length>0?$("#downloadToken1").val(a):$('input[name="downloadToken1"]').val(a);
if($("#downloadToken1").length>0&&$("#downloadToken1").val().length>0||$('input[name="downloadToken1"]').length>0&&$('input[name="downloadToken1"]').val().length>0)ray1.ajax()}else{$("#downloadToken").length>0?$("#downloadToken").val(a):$('input[name="downloadToken"]').val(a);if($("#downloadToken").length>0&&$("#downloadToken").val().length>0||$('input[name="downloadToken"]').length>0&&$('input[name="downloadToken"]').val().length>0)ray.ajax()}fileDownloadCheckTimer=window.setInterval(function(){if(getCookie("fileDownloadToken")==
a){finishDownload();typeof finishDownloadCallback==="function"&&finishDownloadCallback()}},1E3)}}function finishDownload(){window.clearInterval(fileDownloadCheckTimer);setCookie("fileDownloadToken",null);unBlockUI()}
function unBlockUI(){if(document.getElementById("load"))document.getElementById("load").style.visibility="hidden";if(document.getElementById("load1"))document.getElementById("load1").style.visibility="hidden";if(document.getElementById("load2"))document.getElementById("load2").style.visibility="hidden";submitButton&&submitButton.attr("disabled",false)}
function setFormAction(a,c,b,d,e,f,g,j,h,l){if(typeof j==="function")if(!j())return false;if(typeof h==="undefined"||h.length==0)h=true;j=$("#"+a);var i=false;if(typeof f!="undefined"&&f!="")j=$("#"+a,f);if(typeof e!="undefined"&&e!="")i=e;e=j.find("input[name='ec_eti']");typeof c!="undefined"&&c!=""&&j.attr("action",c);typeof b!="undefined"&&b!=""&&j.attr("method",b);e.length>0&&e.val("");formSubmit(a,d,c,i,f,g,h,l)}
function formSubmitMultipartAjax(a,c,b,d,e){if(typeof d==="function")if(!d(false))return false;if(typeof c=="undefined"||c=="")c="html";dojo.require("dojo.io.iframe");dojo.io.iframe.send({form:a,handleAs:c,load:function(f){unBlockUI();var g=f.body.innerHTML,j=$(g),h=$("igerivException",j).length>0,l=$("ul.errormessage",j).length>0||$("ul.errorMessage",j).length>0;if(h||l){var i=errorMessage;if(h)i=$("igerivException",j).html();else if(l)i=g;$.alerts.dialogClass="style_1";jAlert(i,attenzioneMsg.toUpperCase(),
function(){$.alerts.dialogClass=null})}else{if(e){$.alerts.dialogClass="style_1";jAlert(okMessage,msgAvviso.toUpperCase(),function(){$.alerts.dialogClass=null})}typeof b==="function"&&b(g)}return f}})}
function formSubmit(a,c,b,d,e,f,g,j){dojo.xhrPost({form:a,handleAs:"text",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},sync:d,handle:function(h,l){unBlockUI();var i=null;if(typeof c!=="undefined"&&c!=""&&c&&c.length>0)i=typeof e!="undefined"?$("#"+c,e):$("#"+c);var k=$(h),m=$("igerivException",k).length>0;if(typeof h=="error"||m||l.xhr.status!=200){var n=b.indexOf("delete")!=-1?errorMessageDelete:errorMessage;if(m)n=$("igerivException",k).html();if(getBrowser().indexOf("FIREFOX")!=
-1&&i&&i.length>0)i.html("<div style='color:red; width: 180px; border-style: solid; border: 1px solid red; font-size: 12px'>&nbsp;&nbsp;"+n+"&nbsp;&nbsp;</div>");else{k=document.createElement("div");k.style.color="red";k.style.width="180px";k.style.borderStyle="solid";k.style.border="1px solid red";k.style.fontSize="12px";k.innerHTML="&nbsp;&nbsp;"+(b.indexOf("delete")!=-1?errorMessageDelete:errorMessage)+"&nbsp;&nbsp;";if(i&&i.length>0){i.find("div")[0]&&i.empty();i.append(k)}}$.alerts.dialogClass=
"style_1";jAlert(n,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null});typeof j==="function"&&j()}else{n=b.indexOf("delete")!=-1?okMessageDelete:b.indexOf("send")!=-1?bollaInTrasmissione:okMessage;if(getBrowser().indexOf("FIREFOX")!=-1&&i&&i.length>0)i.html("<div style='color:green; width: 180px; border-style: solid; border: 1px solid green;'>&nbsp;&nbsp;"+n+"&nbsp;&nbsp;</div>");else{k=document.createElement("div");k.style.color="green";k.style.width="180px";k.style.borderStyle="solid";
k.style.border="1px solid green";k.innerHTML="&nbsp;&nbsp;"+n+"&nbsp;&nbsp;";if(i&&i.length>0){i.find("div")[0]&&i.empty();i.append(k)}}if(g){$.alerts.dialogClass="style_1";jAlert(n,msgAvviso.toUpperCase(),function(){$.alerts.dialogClass=null;return false})}afterSuccessSave();typeof f==="function"&&f()}onLoadFunction()}})}function refreshimage(){document.getElementById("imgCaptcha").src=document.getElementById("imgCaptcha").src+"#"}
function show_cal(a){if(!cal_obj2){formElement=a;cal_obj2=new RichCalendar;cal_obj2.start_week_day=1;cal_obj2.show_time=false;cal_obj2.default_language="it";cal_obj2.user_onchange_handler=cal2_on_change;cal_obj2.user_onclose_handler=cal2_on_close;cal_obj2.user_onautoclose_handler=cal2_on_autoclose;cal_obj2.parse_date(a.value,format);cal_obj2.show_at_element(a,"adj_right-top");cal_obj2.change_skin("alt")}}
function cal2_on_change(a,c){if(c=="day"){formElement.value=a.get_formatted_date(format);a.hide();cal_obj2=null}}function cal2_on_close(a){a.hide();cal_obj2=null}function cal2_on_autoclose(){cal_obj2=null}function Trim(a){return $.trim(a)}String.prototype.trim=function(){return Trim(this)};String.prototype.replaceAll=function(a,c){for(var b=this,d=b.indexOf(a);d>-1;){b=b.replace(a,c);d=b.indexOf(a)}return b};
String.prototype.replaceAt=function(a,c){return this.substr(0,a)+c+this.substr(a+(c.length==0?1:c.length))};function enableAllFormFields(){for(var a=document.getElementsByTagName("input"),c=0;c<a.length;c++)a[c].disabled=false;a=document.getElementsByTagName("select");for(c=0;c<a.length;c++)a[c].disabled=false}
function disableAllFormFields(){for(var a=arguments,c=a.length,b=$("input:not(input[type=hidden])"),d=0;d<b.length;d++){for(var e=false,f=0;f<c;f++)if(b[d].id!=""&&b[d].id==a[f]){e=true;break}b[d].disabled=!e}b=document.getElementsByTagName("select");for(d=0;d<b.length;d++){e=false;for(f=0;f<c;f++)if(b[d].id!=""&&b[d].id==a[f]){e=true;break}b[d].disabled=!e}}
function loadjscssfile(a,c){if(c=="js"){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a)}else if(c=="css"){b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a)}}String.prototype.startsWith=function(a){return this.match("^"+a)==a};String.prototype.endsWith=function(a){return this.match(a+"$")==a};String.prototype.isInteger=function(a){return!isNaN(parseInt(a))};
function onLoadFunction(){}function getBrowser(){return navigator.userAgent.toUpperCase()}
function getBrowserVersion(){var a=0;if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))a=new Number(RegExp.$1);else if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))a=new Number(RegExp.$1);else if(getBrowser().indexOf("OPERA")!=-1||getBrowser().indexOf("SAFARI")!=-1&&getBrowser().indexOf("CHROME")==-1){if(/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent))a=new Number(RegExp.$1)}else if(/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent))a=new Number(RegExp.$1);return a}
function getBrowserLanguage(){return navigator.language?navigator.language:navigator.userLanguage}function areCookiesEnabled(){var a=false;setCookie("testing","Hello",1);if(getCookie("testing")!=null){a=true;setCookie("testing",null,null)}return a}function setCookie(a,c,b){try{$.cookie(a,c,b)}catch(d){var e=new Date;e.setDate(e.getDate()+b);document.cookie=a+"="+escape(c)+(b==null?"":";expires="+e.toUTCString())}}
function getCookie(a){try{return $.cookie(a)}catch(c){var b=document.cookie.indexOf(a+"=");if(b!=-1){b=b+a.length+1;a=document.cookie.indexOf(";",b);if(a==-1)a=document.cookie.length;return unescape(document.cookie.substring(b,a))}}return null}
function makeBrowserChecks(){var a="";if(getBrowser().indexOf("MSIE")==-1&&getBrowser().indexOf("FIREFOX")==-1&&getBrowser().indexOf("OPERA")==-1&&getBrowser().indexOf("CHROME")==-1&&getBrowser().indexOf("SAFARI")==-1)a=browserNotSupported;if(getBrowser().indexOf("MSIE")!=-1&&getBrowserVersion()<7||getBrowser().indexOf("FIREFOX")!=-1&&getBrowserVersion()<3.5||getBrowser().indexOf("OPERA")!=-1&&getBrowserVersion()<10.5||getBrowser().indexOf("CHROME")!=-1&&getBrowserVersion()<8||getBrowser().indexOf("SAFARI")!=
-1&&getBrowserVersion()<4){a=browserVersionNotSupported.replace("{0}",navigator.userAgent.appName);a+=a!=""?"\n\n"+a:a}areCookiesEnabled()||(a+=a!=""?"\n\n"+cookiesDisabled:cookiesDisabled);if($(window).width()<1E3)a=lowResolutionScreen;if(a!=""){$.alerts.dialogClass="style_1";jAlert(a,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;$("#j_username").focus()});setTimeout(function(){$("#popup_ok").focus()},100)}}
function setChangedFieldAttribute(a){a.parent().find("input:hidden[name^=modificato]").first().val("true")}
function focusBarcodeField(a){var c=a.target?a.target:a.srcElement?a.srcElement:null;if($("#barcode").length>0)if((a.keyCode==13||a.keyCode==32)&&c.type=="text"){a.preventDefault();a=c.id.replace(/([|])/g,"\\$1");var b=a.replace("differenze","").replace("reso","").replace("resoRichiamo","").replace("resoFuoriVoce",""),d=$("#"+a),e=$("#dpeChkbx_"+b);e.length>0?setTimeout(function(){var f=c.value.trim();if(!isNaN(f)&&Number(f)>101){PlaySound("beep3");jConfirm(differenzaMoltoGrandeConfirm.replace("{0}",
f),attenzioneMsg.toUpperCase(),function(g){if(g){e.attr("checked","true");typeof checkboxChanged==="function"?checkboxChanged(e):setChangedFieldAttribute(d);$("#barcode").val("");setTimeout(function(){$("#barcode").focus()},100)}else{d.val("");setTimeout(function(){d.focus()},100)}},true,false)}else{e.attr("checked","true");typeof checkboxChanged==="function"?checkboxChanged(e):setChangedFieldAttribute(d);$("#barcode").val("");setTimeout(function(){$("#barcode").focus()},100)}},100):setTimeout(function(){var f=
c.value.trim();if(!isNaN(f)&&Number(f)>101){PlaySound("beep3");jConfirm(confirmResaInseritaMoltoGrande.replace("{0}",f),attenzioneMsg.toUpperCase(),function(g){if(g){d.trigger("blur");$("#barcode").val("");setTimeout(function(){$("#barcode").focus()},100)}else{d.val("");setTimeout(function(){d.focus()},100)}},true,false)}else{d.trigger("blur");$("#barcode").val("");setTimeout(function(){$("#barcode").focus()},100)}},100);return false}}
function stopRKey(a){if((a.keyCode?a.keyCode:a.charCode)=="13")return false;return true}
function manageBarcodeKeyDown(a){if((a.keyCode?a.keyCode:a.charCode)=="13"){var c=a.target?a.target:a.srcElement?a.srcElement:null;a.preventDefault();a=c.value;c=c.name;if(a.length==0){setTimeout(function(){$.alerts.dialogClass="style_1";jAlert(nessunaPubblicazione,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;nessunaPubblicazioneAction()})},100);return false}else{var b=$("#"+a);if(b.length>0){a=false;if($("#autoincrement").length>0)if($("#autoincrement").attr("checked")==true)a=
true;if(c.length>0)c=c.substring(c.indexOf("_")+1);selectRowByBarcode(b.val(),c,a)}else noBarcodeFoundAction(a)}}}
function selectRowByBarcode(a,c,b){if(a!=""&&$("#"+a)){lastFocusedRow!=""&&lastFocusedRow.css({backgroundColor:lastFocusColor});var d=$("input:text[id='"+c+a+"']"),e=d.val();if(b){if(typeof e==="undefined")d.val(1);else{a=$("#qtaReso");c=isNaN(a.val().trim())?1:Number(a.val().trim());d.val(!isNaN(e)?Number(e)+c:e);a.val(1)}setChangedFieldAttribute(d);validateGiacenza(d);showDialogResoSuperioreGiacenza?setTimeout(function(){PlaySound("beep3");jConfirm(msgResoSuperioreGiacenza,attenzioneMsg.toUpperCase(),
function(f){if(f)doActionsAfterSelectRow(d,b);else{f=!isNaN(e)?Number(e):e;objToFocus.val(f);$("#copieDiv").text(f)}showDialogConfirmNumeroResaRespinto=showDialogResoSuperioreGiacenza=false;objToFocus=null});$("#barcode").val("")},100):doActionsAfterSelectRow(d,b)}else doActionsAfterSelectRow(d,b)}}
function showDialog(a){var c=$("#"+a),b='<div id="close" style="z-index:999999; position:absolute; top:30px; left:630px"><a href="#"><img id="imgClose" src="/app_img/close.gif" style="border-style: none" border="0px" class="btn_close" title="'+chiudiMsg+'" alt="'+chiudiMsg+'"/></a></div>';c.fadeIn("slow",function(){c.prepend(b)});c.css({visibility:"visible",top:"350px",width:"640px",height:"520px","border-color":"#66cccc"});a=(c.height()+80)/2;var d=(c.width()+80)/2;c.css({"margin-top":-a,"margin-left":-d});
addFadeLayerEvents()}function doActionsAfterSelectRow(a,c){var b=a.parent().parent(),d=b.css("backgroundColor");$("#barcode").val("");b.css({backgroundColor:"#ffff66"});a.unbind("keydown",focusBarcodeField);a.keydown(focusBarcodeField);a.select();c?setTimeout(function(){setTotals(a);doAfterAutoIncremetActions(a);$("#barcode").focus()},100):a.focus();var e="";e=$.browser.safari?$("body"):$("html");var f=b.offset().top;e.scrollTop(f);lastFocusedRow=b;lastFocusColor=d}
function setDpeCheckboxState(a){var c=document.getElementsByTagName("input");if(a.checked){a.value="on";for(var b=0;b<c.length;b++)if(c[b].name==a.name)c[b].value="on"}else{a.value="off";for(b=0;b<c.length;b++)if(c[b].name==a.name)c[b].value="off"}}function showMsgDisabledMenuStarterAlert(){jAlert(msgDisabledMenuStarter.replace("{0}",giorniProvaPerStarter),msgAvviso.toUpperCase())}
function setDataTipoBolla(a,c){var b=a.split("|");(b=$("#"+c+" option[value^='"+(b[0]+"|"+b[1])+"']").val())?$("#dataTipoBolla").val(b):$("#dataTipoBolla option:first").attr("selected","selected")}
function spuntaAutomatica(){jConfirm(autoSpuntaMessage,attenzioneMsg.toUpperCase(),function(a){if(a){a=document.getElementsByTagName("input");for(var c=0;c<a.length;c++)if(a[c].type=="checkbox")if(a[c].id.indexOf("dpeChkbx_")!=-1)a[c].checked=true;typeof setAllCheckboxChanged==="function"&&setAllCheckboxChanged()}})}
function spuntaAutomaticaOrdiniClienti(){for(var a=document.getElementsByTagName("input"),c=0;c<a.length;c++)if(a[c].type=="checkbox")if(a[c].id.indexOf("dpeChkbx_")!=-1)a[c].checked=true;typeof setAllCheckboxChanged==="function"&&setAllCheckboxChanged()}
function validateFields(a){var c=null;firstInvalidId="";c=typeof a!="undefined"?$("#"+a+" input:text[validateIsNumeric=true]"):$("input:text[validateIsNumeric=true]");getFirstInvalidField(c);if(typeof firstInvalidId!="undefined"&&firstInvalidId!=""){selectRowByBarcode(firstInvalidId,"",false);unBlockUI();return false}return true}
function validateFieldsClienteBase(a){if($("#inviaEmail").attr("checked")==true&&$("#cliente\\.email").val().trim()==""){if(a){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",emailLabel),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#inviaEmail").focus()})}unBlockUI();return false}if($("#cliente\\.nome").val()==""){if(a){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",nomeLabel),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#cliente\\.nome").focus()})}unBlockUI();
return false}$("#codCliente").attr("disabled",false);return true}function getFirstInvalidField(a){a.each(function(){var c=$(this),b=c.val().trim();if(b!=""&&!bINT(b)){c.css({borderColor:"red"});firstInvalidId=c.attr("id");return false}else c.css({borderColor:"#999"})})}function bINT(a){return parseFloat(a)==parseInt(a)&&!isNaN(a)?true:false}function bDecimal(a){return isNaN(parseFloat(a))||a=="."?false:true}function bBoolean(a){return a.toString()=="true"||a.toString()=="false"?true:false}
function parseLocalNum(a){var c=a;if(typeof a!=="undefined"){c=a.trim();var b=a=0;if(c.match(/\./g))a=c.match(/\./g).length;if(c.match(/,/g))b=c.match(/,/g).length;if(a>1||b>1){$.alerts.dialogClass="style_1";jAlert(numeroNonValido,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;throw numeroNonValido;})}a=c;if(c.indexOf(",")!=-1)c=c.replace(",",".");if(isNaN(c)){c=a.replace(".","");c=c.replace(",",".")}}return c}
function displayNum(a){var c=a;if(a.toString().length>0){if(a.toString().indexOf(".")!=-1)c=a.toString().replace(".",",");if(a.toString().indexOf(",")!=-1)c=addThousandsSeparators(c,",",".")}return c}function addThousandsSeparators(a,c,b){a+="";x=a.split(c);x1=x[0];x2=x.length>1?c+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1"+b+"$2");return x1+x2}
function addWaitingLayerEventOnTableHeader(a){$("#"+a+" tbody tr").find("td[onclick]").each(function(){$(this).click(function(){return ray.ajax()})})}function addWaitingLayerEventOnTableHeaderThead(a){$("#"+a+" thead tr").find("td[onclick]").each(function(){$(this).click(function(){return ray.ajax()})})}function addWaitingLayerEventOnTableRows(a){$("#"+a+" tbody tr").each(function(){$(this).click(function(){return ray.ajax()})})}
function setScrollingTableBody(a,c){var b=$("#"+a+" thead").html();if($("#"+a+" thead tr td").last().text().trim()!=""){var d=b.toUpperCase().lastIndexOf("</TR>");b=b.substring(0,d)+'<td class="tableHeader" width="2%" > </td>'+b.substring(d+5)}b='<table id="headerTable">'+b+"</table>";$("#"+a+" thead").remove();$(b).insertBefore($("#"+c)).addClass("eXtremeTable").css({"border-collapse":"collapse","table-layout":"auto",width:"100%"});addWaitingLayerEventOnTableHeader("headerTable")}
function addFadeLayerEvents(a){var c=$("#close, #fade"),b=$("#closedet"),d=$("#fade, .popup_block"),e=$("#fadedet, #popup_name_det"),f=$("#fadedet, #imgClosedet");if(typeof a!="undefined"){c=$("#close, #fade",a);b=$("#closedet",a);d=$("#fade, .popup_block",a);e=$("#fadedet, #popup_name_det",a);f=$("#fadedet, #imgClosedet",a)}c.live("click",function(){var g=$(this);d.fadeOut(function(){d.die()});if(popupWiderThanViewport){enableDraggingOnPopup(g);popupWiderThanViewport=false}onCloseLayer();return false});
b.live("click",function(){e.fadeOut(function(){f.die();f.remove()});return false})}function addCloseButtonToLayer(a,c,b){c='<div id="close" style="z-index:999999"><a href="#" class="btn_close"><img id="imgClose" src="'+c+'" style="border-style: none" border="0px" class="btn_close" title="'+b+'" alt="'+b+'"/></a></div>';$("#"+a).prepend(c)}
function addTableLastRow(a){if($("#"+a).length>0){var c=Number($("#"+a).css("height").replaceAll("px","").trim()),b=0;$("#"+a+" tbody tr").each(function(){var d=Number($(this).css("height").replaceAll("px","").trim());b+=d==0||d>35?30:d});($("#"+a+" tbody tr").length>1?$("#"+a+" tbody>tr:last").prev().clone(true).find("td").text(""):$("#"+a+" tbody>tr:last").clone(true).find("td").text("")).insertAfter("#"+a+" tbody>tr:last").css({height:c-b+"px"})}}
function addHiddenInput(a,c){$("#"+a+" input:hidden").last().append('<input type="hidden" name="'+c+'" id="'+c+'"/>"')}function setFocusedFieldStyle(a){if(typeof a==="undefined"||a=="")a=window.document;if(getBrowser().indexOf("SAFARI")==-1){$("input[type='text'], select",a).focus(function(){$(this).css("background","#ffff99")});$("input[type='text'], select",a).blur(function(){$(this).css("background","#fff")})}}
function doCloseLayer(a){$("#close").trigger("click");a&&typeof a==="function"&&a()}function doValidationCategoria(){if($("#descrizione",window.parent.document).val().trim()==""){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",descrizione),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#descrizione",window.parent.document).focus()});return false}$("#descrizione",window.parent.document).attr("disabled",false);return true}
function doValidationSottoCategoria(){if($("#descrizione",window.parent.document).val().trim()==""){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",descrizione),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#descrizione",window.parent.document).focus()});return false}$("#descrizione",window.parent.document).attr("disabled",false);return true}
function doValidationProdotti(a){var c=$("#prezzi",window.parent.document).length>0?parseLocalNum($("#prezzi",window.parent.document).val()):"",b=$("#validita",window.parent.document).length>0?$("#validita",window.parent.document).val():"",d=$("#prodottoEdicola\\.descrizioneProdottoA",window.parent.document).val(),e=$("#prodottoEdicola\\.descrizioneProdottoB",window.parent.document).val(),f=$("#prodottoEdicola\\.barcode",window.parent.document).val(),g=$("#codCategoria",window.parent.document).val(),
j=$("#sottoCategoria",window.parent.document).val(),h=$("#attachment1").val().indexOf("/")!=-1?"/":"\\";h=$("#attachment1",window.parent.document).val().substring($("#attachment1",window.parent.document).val().lastIndexOf(h)+1);if(d.trim()==""){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",descrizione),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#prodottoEdicola\\.descrizioneProdottoA",window.parent.document).focus()});return false}if(g==null||g.trim()==""){$.alerts.dialogClass=
"style_1";jAlert(campoObbligatorio.replace("{0}",msgCategoria),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#codCategoria",window.parent.document).focus()});return false}if(j==null||j.trim()==""){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",msgSottoCategoria),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#sottoCategoria",window.parent.document).focus()});return false}if(f.trim()==""){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",barcode),
attenzioneMsg,function(){$.alerts.dialogClass=null;$("#prodottoEdicola\\.barcode",window.parent.document).focus()});return false}if(b.trim()!=""&&!checkDate(b)){$.alerts.dialogClass="style_1";jAlert(dataFormatoInvalido1,attenzioneMsg,function(){$.alerts.dialogClass=null;$("#validita",window.parent.document).focus()});return false}if(c.trim()!=""&&isNaN(parseLocalNum(c.trim()))){$.alerts.dialogClass="style_1";jAlert(prezzoInvalido,attenzioneMsg,function(){$.alerts.dialogClass=null;$("#prezzi",window.parent.document).focus()});
return false}if(h!=""&&!hasOnlyNonAccentCharacters(h)){$.alerts.dialogClass="style_1";jAlert(nomeFileInvalido.replace("{0}",h),attenzioneMsg,function(){$.alerts.dialogClass=null;$("#attachment1",window.parent.document).focus()});return false}$("#PrezziTab_table tbody tr td:nth-child(1)",window.parent.document).each(function(){if($(this).find("input:text").length==0)c+=","+(isNaN(parseLocalNum($(this).text().trim()))?0:parseLocalNum($(this).text().trim()))});$("#PrezziTab_table tbody tr td:nth-child(2)",
window.parent.document).each(function(){if($(this).find("input:text").length==0)b+=","+($(this).text().trim()!="undefined"?$(this).text().trim():"")});if($("#PrezziTab_table").length>0&&c.length==0){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",prezzo),attenzioneMsg,function(){$("#prezzi",window.parent.document).focus();$.alerts.dialogClass=null});return false}var l=true;dojo.xhrGet({url:appContext+"/pubblicazioniRpc_getPneBarcodeOrDescrizione.action?barcode="+f,handleAs:"json",
sync:true,headers:{"Content-Type":"application/json; charset=uft-8"},preventCache:true,handle:function(i){if(i.length>0){for(var k="\n",m=0;m<i.length;m++){if(m>0&&m<i.length)k+="\n";k+="- "+i[m].descrizione}if(i.length>(a=="true"?0:1)){$.alerts.dialogClass="style_1";jAlert(msgBarcodeAssociatoAltriProdotti.replace("{0}",f).replace("{1}",k),attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null});l=false;window.parent.document.stopWaitingDiv=true;return false}}}});$("#prodottoEdicola\\.descrizioneProdottoA",
window.parent.document).val(d.replace(/\u20ac/g,"&#8364;"));$("#prodottoEdicola\\.descrizioneProdottoB",window.parent.document).val(e.replace(/\u20ac/g,"&#8364;"));$("#prezziSelected").val(c);$("#validitaSelected").val(b);$("#prodottoEdicola\\.aliquota",window.parent.document).attr("disabled",false);$("#prodottoEdicola\\.descrizioneProdottoA",window.parent.document).attr("disabled",false);$("#prodottoEdicola\\.descrizioneProdottoB",window.parent.document).attr("disabled",false);$("#codCategoria",
window.parent.document).attr("disabled",false);$("#sottoCategoria",window.parent.document).attr("disabled",false);return l}function htmlEncode(a){$("<div/>").text(a).html();return a}function htmlDecode(a){return $("<div/>").html(a).text()}function promptForEmail(a){if(userType==1)hasProfiloStarter.toString()=="true"?promptPrivacyEdicolaStarter(a):promptPrivacyEdicola(a);else userType==2&&promptPrivacyClienteEdicola(a)}
function promptPrivacyEdicolaStarter(a){var c="{";c+='"testoPrivacyEdicolaStarter2":"'+testoPrivacyEdicolaStarter2.replace("{0}",giorniProvaPerStarter)+'",';c+='"ragioneSociale":"'+ragioneSocialeLabel+'",';c+='"indirizzo":"'+indirizzoLabel+'",';c+='"numCivico":"'+numCivicoLabel+'",';c+='"localita":"'+localitaLabel+'",';c+='"provincia":"'+provinciaLabel+'",';c+='"cap":"'+capLabel+'",';c+='"telefono":"'+telefonoLabel+'",';c+='"cellulare":"'+cellulareLabel+'",';c+='"tipoEdicola":"'+tipoEdicolaLabel+
'",';c+='"email":"'+emailLabel+'"';c+="}";jPromptPrivacyEdicolaStarter(testoPrivacyEdicolaStarter1,"","",msgAccettoPrivacy,c,function(b){if(b!=null&&b!=""){b=jQuery.parseJSON(b);var d=b.tipoLocalita,e=b.indirizzo,f=b.numero,g=b.cap,j=b.localita,h=b.provincia,l=b.telefono,i=b.cellulare,k=b.tipoEdicola,m=b.email;b=appContext+namespace+"/pubblicazioniRpc_sendValidationEmail.action?ragioneSociale="+escape(b.ragioneSociale)+"&tipoLocalita="+d+"&indirizzo="+escape(e)+"&numero="+escape(f)+"&cap="+g+"&localita="+
escape(j)+"&provincia="+h+"&telefono="+l+"&cellulare="+i+"&tipoEdicola="+k+"&email="+escape(m)+"&url="+a;dojo.xhrGet({url:b,handleAs:"json",headers:{"Content-Type":"application/json; charset=uft-8"},preventCache:true,handle:function(n,p){if(p.xhr.status==200){var o=n[0].error;if(typeof o!=="undefined"&&o.length>0){$.alerts.dialogClass="style_1";jAlert(o,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;setTimeout(function(){promptPrivacyEdicolaStarter(a)},100)})}else jAlert(msgInvioEmailVerifica,
msgAvviso,function(){window.location=appContext+namespace+"/j_spring_security_logout"})}else jAlert(msgInvioEmailVerifica,msgAvviso,function(){window.location=appContext+namespace+"/j_spring_security_logout"})}})}},function(){if($("#ragioneSociale").val()==""||$("#ragioneSociale").val().trim()==ragioneSocialeLabel){$("#ragioneSociale").css({border:"1px solid red"});$("#ragioneSociale").focus().select();return false}if($("#indirizzo").val()==""||$("#indirizzo").val().trim()==indirizzoLabel){$("#indirizzo").css({border:"1px solid red"});
$("#indirizzo").focus().select();return false}if($("#numero").val().trim()==""||$("#numero").val().trim()==numCivicoLabel){$("#numero").css({border:"1px solid red"});$("#numero").focus().select();return false}if($("#cap").val().trim()==""||$("#cap").val().trim()==capLabel||$("#cap").val().trim().length<5){$("#cap").css({border:"1px solid red"});$("#cap").focus().select();return false}if($("#localita").val().trim()==""||$("#localita").val().trim()==$("<div/>").html(localitaLabel).text()){$("#localita").css({border:"1px solid red"});
$("#localita").focus().select();return false}if($("#provincia").val()==-1){$("#provincia").css({"background-color":"#ffff99"});$("#provincia").css({border:"1px solid red"});$("#provincia").focus();return false}if(($("#telefono").val().trim()==""||$("#telefono").val().trim()==telefonoLabel)&&($("#cellulare").val().trim()==""||$("#cellulare").val().trim()==cellulareLabel)){$("#telefono").css({border:"1px solid red"});$("#telefono").focus().select();return false}if(($("#telefono").val().trim()==""||
$("#telefono").val().trim()==telefonoLabel)&&($("#cellulare").val().trim()==""||$("#cellulare").val().trim()==cellulareLabel)){$("#cellulare").css({border:"1px solid red"});$("#cellulare").focus().select();return false}if($("#tipoEdicola").val()==-1){$("#tipoEdicola").css({"background-color":"#ffff99"});$("#tipoEdicola").css({border:"1px solid red"});$("#tipoEdicola").focus();return false}if($("#email").val().trim()==""||$("#email").val().trim()==emailLabel){$("#email").css({border:"1px solid red"});
$("#email").focus().select();return false}if(!checkEmail($("#email").val().trim())){$("#email").css({border:"1px solid red"});$("#email").focus().select();return false}if($("#popup_prompt1").is(":checked")!=true){$("#popup_fieldtitle2").css({border:"1px solid red"});$("#popup_prompt1").click(function(){$("#popup_fieldtitle2").css({border:"none"})});return false}return true});setFocusedFieldStyle();$("#ragioneSociale").focus(function(){var b=$(this).val();$(this).val(b==ragioneSocialeLabel?"":b)});
$("#ragioneSociale").blur(function(){var b=$(this).val().trim();$(this).val(b==""?ragioneSocialeLabel:b);$(this).css({border:"none"})});$("#indirizzo").focus(function(){var b=$(this).val();$(this).val(b==indirizzoLabel?"":b)});$("#indirizzo").blur(function(){var b=$(this).val().trim();$(this).val(b==""?indirizzoLabel:b);$(this).css({border:"none"})});$("#numero").focus(function(){var b=$(this).val();$(this).val(b==numCivicoLabel?"":b)});$("#numero").blur(function(){var b=$(this).val().trim();$(this).val(b==
""?numCivicoLabel:b);$(this).css({border:"none"})});$("#cap").focus(function(){var b=$(this).val();$(this).val(b==capLabel?"":b)});$("#cap").blur(function(){var b=$(this).val().trim();$(this).val(b==""?capLabel:b);$(this).css({border:"none"})});$("#localita").focus(function(){var b=$(this).val();$(this).val(b==$("<div/>").html(localitaLabel).text()?"":b)});$("#localita").blur(function(){var b=$(this).val().trim();$(this).val(b==""?$("<div/>").html(localitaLabel).text():b);$(this).css({border:"none"})});
$("#provincia").change(function(){$(this).css({"background-color":"#fff"});$(this).css({border:"none"})});$("#telefono").focus(function(){var b=$(this).val();$(this).val(b==telefonoLabel?"":b)});$("#telefono").blur(function(){var b=$(this).val().trim();$(this).val(b==""?telefonoLabel:b);$(this).css({border:"none"})});$("#cellulare").focus(function(){var b=$(this).val();$(this).val(b==cellulareLabel?"":b)});$("#cellulare").blur(function(){var b=$(this).val().trim();$(this).val(b==""?cellulareLabel:
b);$(this).css({border:"none"})});$("#tipoEdicola").change(function(){$(this).css({"background-color":"#fff"});$(this).css({border:"none"})});$("#email").focus(function(){var b=$(this).val();$(this).val(b==emailLabel?"":b)});$("#email").blur(function(){var b=$(this).val().trim();$(this).val(b==""?emailLabel:b);$(this).css({border:"none"})});$("#popup_prompt1").change(function(){$(this).css({"background-color":"#fff"});$(this).css({border:"none"})});$("#ragioneSociale").focus()}
function promptPrivacyClienteEdicola(a){var c="{";c+='"dtNasc":"'+dtNascLabel+'",';c+='"giorno":"'+giornoLabel+'",';c+='"mese":"'+meseLabel+'",';c+='"anno":"'+annoLabel+'",';c+='"email":"'+emailLabel+'"';c+="}";jPromptPrivacyCliente($.validator.format(privacyMessageLettore,url_Pdf_Privacy),"","",$.validator.format(msgAccettoPrivacy,url_Pdf_Privacy),c,function(b){if(b!=null&&b!=""){b=jQuery.parseJSON(b);var d=b.dtM,e=b.dtA;d=pad(b.dtG,2)+"-"+pad(d,2)+"-"+e;dojo.xhrGet({url:appContext+namespace+"/pubblicazioniRpc_sendValidationEmail.action?dtNasc="+
d+"&sesso="+b.sesso+"&lavoro="+b.lavoro+"&scuola="+b.scuola+"&email="+b.email+"&url="+a,handleAs:"json",headers:{"Content-Type":"application/json; charset=uft-8"},preventCache:true,handle:function(f,g){if(g.xhr.status==200){var j=f[0].error;if(typeof j!=="undefined"&&j.length>0){$.alerts.dialogClass="style_1";jAlert(j,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;setTimeout(function(){promptPrivacyClienteEdicola(a)},100)})}else jAlert(msgInvioEmailVerifica,msgAvviso,function(){window.location=
appContext+namespace+"/j_spring_security_logout"})}else jAlert(msgInvioEmailVerifica,msgAvviso,function(){window.location=appContext+namespace+"/j_spring_security_logout"})}})}},function(){var b=new Date;if($("#dtNascG").val()==""||$("#dtNascG").val().trim()==giornoLabel){$("#dtNascG").focus();return false}if($("#dtNascM").val().trim()==""||$("#dtNascM").val().trim()==meseLabel){$("#dtNascM").focus();return false}if($("#dtNascA").val().trim()==""||$("#dtNascA").val().trim()==annoLabel){$("#dtNascA").focus();
return false}if($("#sesso").val()==-1){$("#sesso").css({"background-color":"#ffff99"});$("#sesso").focus();return false}if($("#lavoro").val()==-1){$("#lavoro").css({"background-color":"#ffff99"});$("#lavoro").focus();return false}if($("#scuola").val()==-1){$("#scuola").css({"background-color":"#ffff99"});$("#scuola").focus();return false}if($("#email").val().trim()==""||$("#email").val().trim()==emailLabel){$("#email").focus();return false}if(Number($("#dtNascG").val())<1||Number($("#dtNascG").val())>
31){$("#dtNascG").focus();return false}if(Number($("#dtNascM").val())<1||Number($("#dtNascM").val())>12){$("#dtNascM").focus();return false}if(Number($("#dtNascA").val())<=b.getFullYear()-120||Number($("#dtNascA").val())>=b.getFullYear()){$("#dtNascA").focus();return false}if(!checkDate($("#dtNascG").val().trim()+"/"+$("#dtNascM").val().trim()+"/"+$("#dtNascA").val().trim())){$("#dtNascG").focus();return false}if(!checkEmail($("#email").val().trim())){$("#email").focus();return false}if($("#popup_prompt1").is(":checked")!=
true){$("#popup_fieldtitle2").css({border:"1px solid red"});$("#popup_prompt1").click(function(){$("#popup_fieldtitle2").css({border:"none"})});return false}return true});setFocusedFieldStyle();$("#dtNascG").focus(function(){var b=$(this).val();$(this).val(b==giornoLabel?"":b)});$("#dtNascG").blur(function(){var b=$(this).val().trim();$(this).val(b==""?giornoLabel:b)});$("#dtNascM").focus(function(){var b=$(this).val();$(this).val(b==meseLabel?"":b)});$("#dtNascM").blur(function(){var b=$(this).val().trim();
$(this).val(b==""?meseLabel:b)});$("#dtNascA").focus(function(){var b=$(this).val();$(this).val(b==annoLabel?"":b)});$("#dtNascA").blur(function(){var b=$(this).val().trim();$(this).val(b==""?annoLabel:b)});$("#email").focus(function(){var b=$(this).val();$(this).val(b==emailLabel?"":b)});$("#email").blur(function(){var b=$(this).val().trim();$(this).val(b==""?emailLabel:b)});$("#sesso").change(function(){$(this).css({"background-color":"#fff"})});$("#lavoro").change(function(){$(this).css({"background-color":"#fff"})});
$("#scuola").change(function(){$(this).css({"background-color":"#fff"})});$("#popup_prompt1").change(function(){$(this).css({"background-color":"#fff"})});$("#dtNascG").focus()}
function promptPrivacyEdicola(a){jPromptPrivacy(privacyMessageEdicola,"","",email,msgAccettoPrivacy,function(c){if(c!=null){c=c.split("|")[0];dojo.xhrGet({url:appContext+namespace+"/pubblicazioniRpc_sendValidationEmail.action?email="+c+"&url="+a,handleAs:"json",headers:{"Content-Type":"application/json; charset=uft-8"},preventCache:true,handle:function(b,d){if(d.xhr.status==200){var e=b[0].error;if(typeof e!=="undefined"&&e.length>0){$.alerts.dialogClass="style_1";jAlert(e,attenzioneMsg.toUpperCase(),
function(){$.alerts.dialogClass=null;setTimeout(function(){promptPrivacyEdicola(a)},100)})}else jAlert(msgInvioEmailVerifica)}else jAlert(msgErroreInvioRichiesta)}})}},function(){if($("#email").val().trim()==""||$("#email").val().trim()==emailLabel){$.alerts.dialogClass="style_1";jAlert(campoObbligatorio.replace("{0}",emailLabel),attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;promptForEmail(a)});$("#email").focus();return false}if(!checkEmail($("#email").val().trim())){$.alerts.dialogClass=
"style_1";jAlert(msgInvalidEmail,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;promptForEmail(a)});$("#email").focus();return false}if($("#popup_prompt1").is(":checked")!=true){$("#popup_fieldtitle2").css({border:"1px solid red"});$("#popup_prompt1").click(function(){$("#popup_fieldtitle2").css({border:"none"})});return false}return true});setFocusedFieldStyle()}
function attivaPeriodoProvaStarter(){jConfirm(attivaPeriodoProvaConfirm.replace("{0}",giorniProvaPerStarter).replace("{1}",giorniProvaPerStarter),attenzioneMsg.toUpperCase(),function(a){if(a)dojo.xhrGet({url:appContext+namespace+"/pubblicazioniRpc_attivaPeriodoProva.action",handleAs:"json",headers:{"Content-Type":"application/json; charset=uft-8"},preventCache:true,handle:function(c,b){if(b.xhr.status==200)if(typeof c.error!=="undefined"&&c.error!=""){$.alerts.dialogClass="style_1";jAlert(c.error,
attenzioneMsg,function(){$.alerts.dialogClass=null;return false})}else{var d=new Date,e=pad(d.getDate(),2),f=pad(d.getMonth()+1,2),g=d.getFullYear();e=e+"/"+f+"/"+g;f=new Date;f.setDate(d.getDate()+Number(15));d=pad(f.getDate(),2);g=pad(f.getMonth()+1,2);f=f.getFullYear();d=d+"/"+g+"/"+f;jAlert(msgAttivazionePeridoProvaEseguita.replace("{0}",giorniProvaPerStarter).replace("{1}",e).replace("{2}",d),msgAvviso,function(){window.location=appContext+namespace+"/j_spring_security_logout"})}else jAlert(msgErroreInvioRichiesta)}});
else{$textField.val("");setTimeout(function(){$textField.focus()},100)}},true,false)}function pad(a,c){for(var b=""+a;b.length<c;)b="0"+b;return b}function hasOnlyNonAccentCharacters(a){return/^(?=.*[A-Za-z0-9])[A-Za-z0-9 _,.-]*$/.test(a)}
function openDiv(a,c,b,d,e,f,g,j){var h=$("#"+a);if(typeof g!="undefined"&&g!="")h=$("#"+a,g);c>$(window).width()?h.fadeIn().css({width:"90%",height:"80%"}):h.fadeIn().css({width:Number(c),height:Number(b)});a=(h.height()+80)/2;b=(h.width()+80)/2;g="#ccccff";f=typeof f!="undefined"&&f.length>0?f:"";if(typeof e!="undefined"&&e.length>0)g=e;e="btn_close";if(c>$(window).width()){popupWiderThanViewport=true;h.draggable("destroy");e="btn_closeScrollable";getBrowser().indexOf("MSIE")!=-1?h.css({"margin-top":-a,
"margin-left":-b,"background-color":g,overflow:"auto"}):h.css({"margin-top":-a,"margin-left":-b,"background-color":g,"overflow-y":"scroll"})}else h.css({"margin-top":-a,"margin-left":-b,"background-color":g});h.html('<div style="position:absolute; width:100%; text-align:center; margin-left:auto; margin-right:auto; margin-top:10%;"><p><img src="/app_img/ajax-loader.gif" width="220px" height="19px" /></p></div>');var l='<div id="close'+f+'" style="z-index:999999;"><a href="#" class="btn_close"><img id="imgClose'+
f+'" src="/app_img/close.gif" style="border-style: none" border="0px" class="'+e+'" title="'+chiudiLabel+'" alt="'+chiudiLabel+'"/></a></div>';if(d.length>0){d=d+(d.indexOf("?")==-1?"?":"&")+"ispopup=true";h.load(d,function(){h.prepend(l);typeof j==="function"&&j()})}getBrowser().indexOf("MSIE")!=-1?h.css({"border-color":"#3399cc"}):$("body").append('<div id="fade'+f+'"></div>')}
function findDuplicates(a){for(var c=a.length,b=[],d={},e=0;e<c;e++){var f=a[e];d[f]=d[f]>=1?d[f]+1:1}for(f in d)d[f]>1&&b.push(f);return b}function sleep(a){var c=new Date;for(c.setTime(c.getTime()+a);(new Date).getTime()<c.getTime(););}
function checkDate(a){var c,b;if(/\b\d{1,2}[\/-]\d{1,2}[\/-]\d{4}\b/.test(a)){b=a.indexOf("/")!=-1?"/":"-";c=a.indexOf(b);var d=a.lastIndexOf(b);b=parseInt(a.substring(0,c),10);c=parseInt(a.substring(c+1,d),10);a=parseInt(a.substring(d+1),10);d=new Date(a,c-1,b);return d.getDate()==b?d.getMonth()+1==c?d.getFullYear()==a?true:false:false:false}else return false}function checkEmail(a){if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a))return true}
function autoSaveBolle(a){function c(){switch(tipoBolla){case BOLLA_CONSEGNA:if($("#BollaControlloForm input:hidden[name^=modificato][value=true]").length>0){validateFields("BollaControlloForm");setFieldsToSave(true)&&setFormAction("BollaControlloForm","bollaRivendita_save.action","","messageDiv",false,"",function(){setFieldsToSave(false)},"",false);return false}break;case BOLLA_RESA:if($("#BollaResaForm input:hidden[name^=modificato][value=true]").length>0){validateFields("BollaResaForm");setFieldsToSave(true)&&
setFormAction("BollaResaForm","bollaResa_save.action","","messageDiv",false,"",function(){setFieldsToSave(false);deleteEmptyRowsFuoriVoce()},"",false);return false}}}this.StartPolling=function(){this.StopPolling();this.timer=setInterval(c,a)};this.StopPolling=function(){clearInterval(this.timer)};this.setPollInterval=function(b){a=b}}
function highPriorityMessagesCheck(a){function c(){generalRpcService&&generalRpcService.getPkHighPriorityMessage().addCallback(function(b){var d=$("#parentMessageDiv");if(b!=""&&(d.length==0||d.is(":hidden")))showAlertMessaggioAltaPriorita(b)})}this.StartPolling=function(){this.StopPolling();this.timer=setInterval(c,a)};this.StopPolling=function(){clearInterval(this.timer)};this.setPollInterval=function(b){a=b}}
function getNoteRivendita(a,c){return a.length>0?a:typeof c!="undefined"&&c.length>0?c:msgNoteRivendita}
function showAlertMessaggioAltaPriorita(a){a=appContext+namespace+"/avviso_showAvvisoNuovoMessaggio.action?messagePk="+a;var c=$("<div id='parentMessageDiv' class='new_message_popup_block'>");c.css({width:"150px",height:"120px","text-align":"center","margin-left":"43%","margin-right":"auto","font-weight":"bold","font-size":"100%",position:"absolute",border:"1px solid black","z-index":"999999"});$("body").prepend(c);c.hide();c.load(a,{limit:25},function(){c.slideDown("slow")})}
function addNote(a,c,b){var d=$("#noteRivenditaCpu"+b).val(),e=$("#noteRivendita"+c).val(),f=typeof d!="undefined"&&d.trim().length>0;d=typeof e!="undefined"&&e.trim().length>0?e:d;jPromptNote(msgNotePubblicazione.replace("{0}",a),d,f,msgNoteRivendita,msgNoteFisse,function(g){if(g!=null){var j=g.split("|")[0].trim(),h=g.split("|")[1].trim();dojo.xhrGet({url:appContext+namespace+"/pubblicazioniRpc_saveNotaRivendita.action?idtn="+c+"&notaRivendita="+escape(j)+"&cpu="+b+"&notaFissa="+h,preventCache:true,
handleAs:"text",handle:function(){var l=$("#noteRiv"+c);$("#noteRivenditaCpu"+b).val(h=="true"?j:"");$("#noteRivendita"+c).val(h=="false"?j:"");l.attr("title",j.length>0?j:msgNoteRivendita);l.attr("src","/app_img/"+(j.trim().length==0?"note_rivendita.gif":"note_rivendita_red.gif"));l.tooltip({delay:0,showURL:false});var i=l.closest("td").prev("td").find("input:text").first();setTimeout(function(){$("#barcode").length>0&&i.keydown(function(k){(k.keyCode?k.keyCode:k.charCode)=="13"&&$("#barcode").focus()});
i.focus()},100)}})}})}
function networkDetection(a,c){function b(){try{dojo.xhrGet({url:a,handleAs:"text",preventCache:true,load:function(e){if(e!="undefined"&&e.indexOf("j_spring_security_check")!=-1){$.alerts.dialogClass="style_1";jAlert(sessionScadutaRedirectLoginMsg,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;window.location.href=appContext+namespace+"/j_spring_security_logout"})}pingFailureCount=0;online=true},error:function(){if(pingFailureCount>=3){$.alerts.dialogClass="style_1";jAlert(userOfflineMsg,
attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;pingFailureCount=0})}online=false;pingFailureCount++}})}catch(d){dojo.io.bind({url:a,load:function(e,f){if(f!="undefined"&&f.indexOf("j_spring_security_check")!=-1){$.alerts.dialogClass="style_1";jAlert(sessionScadutaRedirectLoginMsg,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;window.location.href=appContext+namespace+"/j_spring_security_logout"})}pingFailureCount=0;online=true},error:function(){if(pingFailureCount>=
3){$.alerts.dialogClass="style_1";jAlert(userOfflineMsg,attenzioneMsg.toUpperCase(),function(){$.alerts.dialogClass=null;pingFailureCount=0})}online=false;pingFailureCount++},mimetype:"text/plain"})}}online=false;this.StartPolling=function(){this.StopPolling();this.timer=setInterval(b,c)};this.StopPolling=function(){clearInterval(this.timer)};this.setPollInterval=function(d){c=d};this.getOnlineStatus=function(){return online}}
(function(a){a.fn.hasScrollBar=function(){var c=0,b=0;if(getBrowser().indexOf("OPERA")!=-1)b=40;try{c=this.get(0).scrollHeight-b}catch(d){c=this.scrollHeight-b}return c>this.height()}})(jQuery);