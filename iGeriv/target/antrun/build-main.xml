<?xml version="1.0" encoding="UTF-8" ?>
<project name="maven-antrun-" default="main"  >
<target name="main">
  <pathconvert pathsep=" " property="runtimelibs.path">
    <fileset dir="${project_loc}/target/igeriv/WEB-INF/lib">
      <include name="*.jar"/>
    </fileset>
    <mapper>
      <chainedmapper>
        <flattenmapper/>
        <globmapper to="*.jar" casesensitive="no" from="*.jar"/>
      </chainedmapper>
    </mapper>
  </pathconvert>
  <jar destfile="${project_loc}/target/igeriv/WEB-INF/lib/classes.jar">
    <fileset dir="${project_loc}\target\classes">
      <include name="**/*"/>
    </fileset>
    <manifest>
      <attribute name="Manifest-Version" value="1.0"/>
      <attribute name="Class-Path" value="${runtimelibs.path}"/>
    </manifest>
  </jar>
  <copy file="${project_loc}/WebContent/favicon_iGeriv.ico" tofile="${project_loc}\target/igeriv/favicon.ico" overwrite="true"/>
  <copy file="${project_loc}/WebContent/META-INF/context_iGeriv.xml" tofile="${project_loc}\target/igeriv/META-INF/context.xml" overwrite="true"/>
  <copy file="${project_loc}/WebContent/META-INF/context_iGeriv.xml" tofile="${project_loc}/WebContent/META-INF/context.xml" overwrite="true"/>
  <delete dir="${project_loc}/WebContent/applet" excludes=".svn">
    <include name="*.jar"/>
  </delete>
  <delete dir="${project_loc}\target/igeriv/applet" excludes=".svn">
    <include name="*.jar"/>
  </delete>
  <delete dir="${project_loc}\target/igeriv/applet/signed"/>
  <copy todir="${project_loc}\target/igeriv/applet" overwrite="true">
    <fileset dir="${project_loc}/target/igeriv/WEB-INF/lib">
      <include name="json-lib-2.3.jar"/>
      <include name="ezmorph-1.0.3.jar"/>
      <include name="commons-collections-3.1.jar"/>
      <include name="commons-lang-2.0.jar"/>
      <include name="commons-logging-1.1.1.jar"/>
      <include name="commons-beanutils-1.8.0.jar"/>
      <include name="commons-io-1.3.2.jar"/>
      <include name="commons-net-2.0.jar"/>
      <include name="httpclient-4.0.1.jar"/>
      <include name="httpcore-4.0.1.jar"/>
      <include name="spring-security-core-3.2.0.RELEASE.jar"/>
      <include name="mail-1.5.0-b01.jar"/>
      <include name="activation-1.1.1.jar"/>
      <include name="guava-10.0.1.jar"/>
    </fileset>
  </copy>
  <move file="${project_loc}\target/igeriv/applet/activation-1.1.1.jar" tofile="${project_loc}\target/igeriv/applet/activation.jar" overwrite="true"/>
  <property file="${project_loc}/src/main/resources/package_it.properties"/>
  <taskdef resource="net/sf/antcontrib/antlib.xml"/>
  <for param="jarFile">
    <path>
      <fileset dir="${project_loc}\target/igeriv/applet" includes="**/*.jar"/>
    </path>
    <sequential>
      <jar update="true" file="@{jarFile}">
        <manifest>
          <attribute name="Permissions" value="all-permissions"/>
          <attribute name="Codebase" value="*"/>
          <attribute name="Trusted-Library" value="true"/>
        </manifest>
      </jar>
    </sequential>
  </for>
  <jar index="true" destfile="${project_loc}\target/igeriv/applet/regCassaApplet${igeriv.version.timestamp}.jar">
    <fileset dir="${project_loc}\target\classes">
      <include name="it/dpe/igeriv/web/applet/regcassa/**/*.*"/>
      <include name="**/WindowsRegistry*.class"/>
      <include name="**/ClientMessageBundle.class"/>
      <include name="package_client_it.properties"/>
    </fileset>
    <manifest>
      <attribute name="Manifest-Version" value="1.0"/>
      <attribute name="Class-Path" value="json-lib-2.3.jar ezmorph-1.0.3.jar commons-collections-3.1.jar commons-lang-2.0.jar commons-logging-1.1.1.jar commons-beanutils-1.8.0.jar commons-io-1.3.2.jar commons-net-2.0.jar httpclient-4.0.1.jar httpcore-4.0.1.jar spring-security-core-3.2.0.RELEASE.jar mail-1.5.0-b01.jar activation.jar guava-10.0.1.jar"/>
      <attribute name="Permissions" value="all-permissions"/>
      <attribute name="Codebase" value="*"/>
      <attribute name="Application-Name" value="Registratore_Di_Cassa"/>
      <attribute name="Application-Library-Allowable-Codebase" value="*"/>
      <attribute name="Caller-Allowable-Codebase" value="*"/>
    </manifest>
    <indexjars>
      <fileset dir="${project_loc}\target/igeriv/applet">
        <include name="json-lib-2.3.jar"/>
        <include name="ezmorph-1.0.3.jar"/>
        <include name="commons-collections-3.1.jar"/>
        <include name="commons-lang-2.0.jar"/>
        <include name="commons-logging-1.1.1.jar"/>
        <include name="commons-beanutils-1.8.0.jar"/>
        <include name="commons-io-1.3.2.jar"/>
        <include name="commons-net-2.0.jar"/>
        <include name="httpclient-4.0.1.jar"/>
        <include name="httpcore-4.0.1.jar"/>
        <include name="spring-security-core-3.2.0.RELEASE.jar"/>
        <include name="mail-1.5.0-b01.jar"/>
        <include name="activation.jar"/>
        <include name="guava-10.0.1.jar"/>
      </fileset>
    </indexjars>
  </jar>
</target>
</project>